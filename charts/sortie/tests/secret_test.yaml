suite: Secret template tests
templates:
  - templates/secret.yaml
tests:
  - it: should include SORTIE_DB_PASSWORD for Postgres with password and no existingSecret
    set:
      database.type: postgres
      database.postgres.password: s3cret
    asserts:
      - equal:
          path: stringData.SORTIE_DB_PASSWORD
          value: "s3cret"

  - it: should not include SORTIE_DB_PASSWORD when Postgres uses existingSecret
    set:
      database.type: postgres
      database.postgres.password: s3cret
      database.postgres.existingSecret: my-pg-secret
    asserts:
      - isNull:
          path: stringData.SORTIE_DB_PASSWORD

  - it: should not include SORTIE_DB_PASSWORD for Postgres without password
    set:
      database.type: postgres
    asserts:
      - isNull:
          path: stringData.SORTIE_DB_PASSWORD

  - it: should not include SORTIE_DB_PASSWORD for SQLite
    set:
      database.type: sqlite
    asserts:
      - isNull:
          path: stringData.SORTIE_DB_PASSWORD
