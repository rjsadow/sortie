[supervisord]
nodaemon=true
user=appuser
logfile=/var/log/supervisor/supervisord.log
pidfile=/run/supervisor/supervisord.pid
childlogdir=/var/log/supervisor

[program:xvfb]
command=/usr/bin/Xvfb %(ENV_DISPLAY)s -screen 0 %(ENV_SCREEN_RESOLUTION)s -ac +extension GLX +render -noreset
priority=10
autostart=true
autorestart=true
startsecs=2
startretries=3
stdout_logfile=/var/log/supervisor/xvfb.log
stdout_logfile_maxbytes=10MB
stderr_logfile=/var/log/supervisor/xvfb-error.log
stderr_logfile_maxbytes=10MB

[program:openbox]
command=/usr/bin/openbox-session
priority=15
autostart=true
autorestart=true
startsecs=3
startretries=3
stdout_logfile=/var/log/supervisor/openbox.log
stdout_logfile_maxbytes=10MB
stderr_logfile=/var/log/supervisor/openbox-error.log
stderr_logfile_maxbytes=10MB

[program:x11vnc]
command=/usr/bin/x11vnc -display %(ENV_DISPLAY)s -forever -shared -rfbport %(ENV_VNC_PORT)s -nopw -xkb -noxrecord -noxfixes -noxdamage -wait 5
priority=20
autostart=true
autorestart=true
startsecs=5
startretries=3
stdout_logfile=/var/log/supervisor/x11vnc.log
stdout_logfile_maxbytes=10MB
stderr_logfile=/var/log/supervisor/x11vnc-error.log
stderr_logfile_maxbytes=10MB

[program:websockify]
command=/usr/bin/websockify %(ENV_WEBSOCKET_PORT)s localhost:%(ENV_VNC_PORT)s
priority=30
autostart=true
autorestart=true
startsecs=3
startretries=3
stdout_logfile=/var/log/supervisor/websockify.log
stdout_logfile_maxbytes=10MB
stderr_logfile=/var/log/supervisor/websockify-error.log
stderr_logfile_maxbytes=10MB

[program:browser]
command=/usr/local/bin/start-browser.sh
priority=40
autostart=true
autorestart=true
startsecs=5
startretries=5
stdout_logfile=/var/log/supervisor/browser.log
stdout_logfile_maxbytes=10MB
stderr_logfile=/var/log/supervisor/browser-error.log
stderr_logfile_maxbytes=10MB
